<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:model="clr-namespace:RankingApp.Models"
             xmlns:views="clr-namespace:RankingApp.ViewModels"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             x:DataType="views:TournamentViewModel"
             x:Class="RankingApp.Views.Tournaments"
             Title="Tournament"
             Style="{StaticResource PrimaryContentPage}">
    <Grid Style="{StaticResource PrimaryGrid}" RowDefinitions="50, 50, 50, *" ColumnDefinitions="10, *, 70, 100">
        <!-- Row 0 -->
        <Label Grid.Column="1" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding Tournament.Name}" FontSize="24"/>
        
        <!-- Row 1 -->
        <HorizontalStackLayout Grid.Row="1" Grid.Column="1" Style="{StaticResource PrimaryHorizontal}">
            <Label Text="{Binding Tournament.TournamentPlayerName}" Style="{StaticResource PrimaryLabel}" />
            <Label Text="{Binding Tournament.TournamentPlayerSurname}" Style="{StaticResource PrimaryLabel}" />
        </HorizontalStackLayout>
        <Label Grid.Row="1" Grid.Column="2" Style="{StaticResource PrimaryLabel}" Text="{Binding Tournament.Coefficient}" />
        <Label Grid.Row="1" Grid.Column="3" Style="{StaticResource PrimaryLabel}" Text="{Binding Tournament.DateToString}" />
        
        <!-- Row 2 -->
        <ImageButton Grid.Row="2" Grid.Column="1" HorizontalOptions="Start" WidthRequest="50" HeightRequest="50" Style="{StaticResource PrimaryImageButton}"
                     Source="plusnoborder.png" x:Name="BtnAddGame" Clicked="BtnAddGame_OnClicked" />
        <Label Grid.Row="2" Grid.Column="2" Style="{StaticResource PrimaryLabel}" Text="{Binding Tournament.PointsDifference}" FontSize="30"/>
        <ImageButton Grid.Row="2" Grid.Column="3" WidthRequest="50" HeightRequest="50" Style="{StaticResource PrimaryImageButton}"
                     Source="racketsnoborder.png" x:Name="BtnSaveTournament" Clicked="BtnSave_OnClicked" />
        <!-- Row 3 -->
        <ListView x:Name="ListViewTournamentGames" ItemsSource="{Binding Games}" Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3"
                  Style="{StaticResource PrimaryListView}" ItemSelected="ListViewTournamentGames_ItemSelected">
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="model:Game">
                    <ViewCell>
                        <VerticalStackLayout Style="{StaticResource PrimaryVertical}">
                            <Label Text="{Binding OpponentName}" Padding="0" Style="{StaticResource ListItemLabel}" FontSize="16"/>
                            <HorizontalStackLayout Spacing="7" Style="{StaticResource PrimaryHorizontal}">
                                <Label Text="{Binding GameScore}" Style="{StaticResource ListItemLabel}"/>
                                <Label Text="Points change" Style="{StaticResource ListItemLabel}"/>
                                <Label Text="{Binding RatingDifference}" Style="{StaticResource ListItemLabel}"/>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                        <ViewCell.ContextActions>
                            <MenuItem Text="Delete" IsDestructive="True" Clicked="MenuItem_OnClicked" CommandParameter="{Binding .}"></MenuItem>
                        </ViewCell.ContextActions>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </Grid>
</ContentPage>