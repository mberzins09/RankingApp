<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:viewmodel="clr-namespace:RankingApp.ViewModels"
             xmlns:model="using:RankingApp.Models"
             x:DataType="viewmodel:GameViewModel"
             x:Class="RankingApp.Views.Games"
             Title="Game"
             Style="{StaticResource PrimaryContentPage}">
    <Grid RowDefinitions="50, 3, 40, 40, 40, 40, 40, 40, 3, *, 50" ColumnDefinitions="3, 50, 50, 50, *, 50, 50, 50, 3" Style="{StaticResource PrimaryGrid}">
        <!-- Row 0 -->
        <ImageButton Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="3" WidthRequest="50" HeightRequest="50" Source="savenoborder.png"
                     x:Name="ButtonGameSave" Clicked="ButtonGameSave_OnClicked" Style="{StaticResource PrimaryImageButton}" />
        <Label Grid.Row="0" Grid.Column="5" Grid.ColumnSpan="3" x:Name ="LabelRatingDifference" 
               Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.RatingDifference}"  FontSize="24"/>
        <!-- Row 1 -->
        <!-- Row 2 -->
        <HorizontalStackLayout Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3" Style="{StaticResource PrimaryHorizontal}">
            <Label Text="{Binding OneGame.MyName}" Style="{StaticResource PrimaryLabel}" />
            <Label Text="{Binding OneGame.MySurname}" Style="{StaticResource PrimaryLabel}"/>
        </HorizontalStackLayout>
        <HorizontalStackLayout Grid.Row="2" Grid.Column="4" Style="{StaticResource PrimaryHorizontal}">
            <Label Style="{StaticResource PrimaryLabel}" Text="-" />
            <Label Style="{StaticResource PrimaryLabel}" Text="VS" />
            <Label Style="{StaticResource PrimaryLabel}" Text="-" />
        </HorizontalStackLayout>
        <HorizontalStackLayout Grid.Row="2" Grid.Column="5" Grid.ColumnSpan="3" Style="{StaticResource PrimaryHorizontal}">
            <Label Text="{Binding OneGame.Name}" Style="{StaticResource PrimaryLabel}" />
            <Label Text="{Binding OneGame.Surname}" Style="{StaticResource PrimaryLabel}"/>
        </HorizontalStackLayout>
        <!-- Row 3 -->
        <Label Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.MyPlace}"/>
        <Label Grid.Row="3" Grid.Column="4" Style="{StaticResource PrimaryLabel}" Text="Place"/>
        <Label Grid.Row="3" Grid.Column="5" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.OpponentPlace}"/>
        <!-- Row 4 -->
        <Label Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.MyPoints}"/>
        <Label Grid.Row="4" Grid.Column="4" Style="{StaticResource PrimaryLabel}" Text="Points"/>
        <Label Grid.Row="4" Grid.Column="5" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.OpponentPoints}"/>
        <!-- Row 5 -->
        <Label Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.MyPointsWithBonus}"/>
        <Label Grid.Row="5" Grid.Column="4" Style="{StaticResource PrimaryLabel}" Text="PointsBonus"/>
        <Label Grid.Row="5" Grid.Column="5" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.OpponentPointsWithBonus}"/>
        <!-- Row 6 -->
        <Label Grid.Row="6" Grid.Column="1" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.MyAge}"/>
        <Label Grid.Row="6" Grid.Column="4" Style="{StaticResource PrimaryLabel}" Text="Age"/>
        <Label Grid.Row="6" Grid.Column="5" Grid.ColumnSpan="3" Style="{StaticResource PrimaryLabel}" Text="{Binding OneGame.OpponentAge}"/>
        <!-- Row 7 -->
        <Picker Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="3" x:Name="MySetsPicker" Title="Sets"
                Style="{StaticResource PrimaryPicker}" ItemsSource="{Binding SetsOptions}" SelectedItem="{Binding OneGame.MySets}"/>
        <Label Grid.Row="7" Grid.Column="4" Style="{StaticResource PrimaryLabel}" Text="Score"/>
        <Picker Grid.Row="7" Grid.Column="5" Grid.ColumnSpan="3" x:Name="OpponentSetsPicker" Title="Sets" 
                Style="{StaticResource PrimaryPicker}" ItemsSource="{Binding SetsOptions}" SelectedItem="{Binding OneGame.OpponentSets}"/>
        <!-- Row 8 -->
        <!-- Row 9 -->
        <Grid Grid.Row="9" Grid.Column="1" Grid.ColumnSpan="7" RowDefinitions="40,*" Style="{StaticResource PrimaryGrid}">
            <SearchBar Grid.Row="0" Text="{Binding SearchText, Mode=TwoWay}" Style="{StaticResource PrimarySearchBar}"/>
            <ListView Grid.Row="1" ItemsSource="{Binding Players}" SelectedItem="{Binding SelectedOpponent}" Style="{StaticResource PrimaryListView}">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="model:PlayerDB">
                        <ViewCell>
                            <Grid ColumnDefinitions="*, 50">
                                <Label Grid.Column="0" Text="{Binding Display}" Style="{StaticResource ListItemLabel}" LineBreakMode="TailTruncation" MaxLines="1"/>
                                <Label Grid.Column="1" Text="{Binding PointsWithBonus}" Style="{StaticResource ListItemLabel}"/>
                            </Grid>
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>
        <!-- Row 10 -->
        <Entry Grid.Row="10" Grid.Column="1" Grid.ColumnSpan="2" x:Name="EntryOpponentName" Placeholder="Name" TextChanged="EntryOppName_OnTextChanged"
               Style="{StaticResource PrimaryEntry}" WidthRequest="99" HeightRequest="49" />
        <Entry Grid.Row="10" Grid.Column="3" Grid.ColumnSpan="2" x:Name="EntryOpponentSurname" Placeholder="Surname" TextChanged="EntryOppName_OnTextChanged"
               Style="{StaticResource PrimaryEntry}" WidthRequest="99" HeightRequest="49" />
        <Picker Grid.Row="10" Grid.Column="6" Grid.ColumnSpan="2" Style="{StaticResource PrimaryPicker}" 
                ItemsSource="{Binding IsOpponentForeignOptions}" SelectedItem="{Binding SelectedOpponentForeignOption, Mode=TwoWay}"
                ItemDisplayBinding="{Binding Label}" >
        </Picker>
    </Grid>
</ContentPage>